"use strict";var _slicedToArray=function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,n){var c=[],i=!0,r=!1,t=void 0;try{for(var a,o=e[Symbol.iterator]();!(i=(a=o.next()).done)&&(c.push(a.value),!n||c.length!==n);i=!0);}catch(e){r=!0,t=e}finally{try{!i&&o.return&&o.return()}finally{if(r)throw t}}return c}(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")},_createClass=function(){function i(e,n){for(var c=0;c<n.length;c++){var i=n[c];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,n,c){return n&&i(e.prototype,n),c&&i(e,c),e}}(),_marked=regeneratorRuntime.mark(fib);function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}var FibonacciGeneratorMaker=function(){function e(){_classCallCheck(this,e),this.returnValue}return _createClass(e,[{key:"fibonacci",value:regeneratorRuntime.mark(function e(n,c){var i,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.makeFibonnaciBlock(n),this.placeFibonacciBlockOnPage(i,c),!(2<n)){e.next=5;break}return void(e.next=5);case 5:if(r=0,1!=n&&2!=n){e.next=10;break}r=1,e.next=14;break;case 10:return e.delegateYield(this.generateFibonacci(n-1,i),"t0",11);case 11:return r+=this.returnValue,e.delegateYield(this.generateFibonacci(n-2,i),"t1",13);case 13:r+=this.returnValue;case 14:return this.showFunctionHasResolved(r,i),e.next=17,r;case 17:case"end":return e.stop()}},e,this)})},{key:"generateFibonacci",value:regeneratorRuntime.mark(function e(n,c){var i,r,t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:i=this.fibonacci(n,c),r=i.next(),t=void 0;case 3:if(r.done){e.next=10;break}return t=r.value,void(e.next=7);case 7:r=i.next(),e.next=3;break;case 10:this.returnValue=t;case 11:case"end":return e.stop()}},e,this)})},{key:"makeFibonnaciBlock",value:function(e){var n=document.createElement("div");return n.classList.add("fibonacci-block__child"),n.innerHTML='<div class="fibonacci-block">\n                                        <p class="fibonacci-block__function-name fibonacci-block__top-row">fib('+e+')</p>\n                                        <p class="fibonacci-block__return-value fibonacci-block__bottom-row">waiting</p>\n                                    </div>',n}},{key:"showFunctionHasResolved",value:function(e,n){var c=n.querySelector(".fibonacci-block__return-value"),i=n.querySelector(".fibonacci-block__function-name");c.innerHTML=e.toString(),c.classList.add("fibonacci-block__return-value--returned"),i.classList.add("fibonacci-block__function-name--resolved")}},{key:"placeFibonacciBlockOnPage",value:function(e,n){n.appendChild(e)}}]),e}();function fibonacciBlockMaker(e){var n=document.createElement("div");return n.classList.add("fibonacci-block__child"),n.innerHTML=1==e||2==e?'<div class="fibonacci-block">\n                                        <p class="fibonacci-block__function-name fibonacci-block__function-name--resolved fibonacci-block__top-row">fib('+e+')</p>\n                                        <p class="fibonacci-block__return-value fibonacci-block__return-value--returned fibonacci-block__bottom-row">1</p>\n                                    </div>':'<div class="fibonacci-block">\n                                        <p class="fibonacci-block__function-name fibonacci-block__top-row">fib('+e+')</p>\n                                        <p class="fibonacci-block__return-value fibonacci-block__bottom-row">waiting</p>\n                                    </div>',n}var fibonacciDemoContainer=document.querySelector(".fibonacci-demo"),fibonacciWrapper=document.querySelector(".fibonacci-wrapper");function fibonacci(t,r){return new Promise(function(i){setTimeout(function(){var e=void 0,n=(e=fibonacciDemoContainer.hasChildNodes()?fibonacciBlockMaker(t,!1):fibonacciBlockMaker(t,!0)).querySelector(".fibonacci-block__return-value"),c=e.querySelector(".fibonacci-block__function-name");r.append(e),i([e,n,c])},500)}).then(function(e){var n=_slicedToArray(e,3),c=n[0],i=n[1],r=n[2];return 1==t||2==t?new Promise(function(e){setTimeout(function(){e(1)},500)}):new Promise(function(e){e(fibonacci(t-1,c).then(function(n){return fibonacci(t-2,c).then(function(e){return[n,e]})}).then(function(e){var n=_slicedToArray(e,2);return n[0]+n[1]}))}).then(function(n){return new Promise(function(e){setTimeout(function(){i.innerHTML=n.toString(),i.classList.add("fibonacci-block__return-value--returned"),r.classList.add("fibonacci-block__function-name--resolved"),e(n)},500)})})})}function fib(n,c){var i,r,t,a,o,u,l,s,f,b;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=fibonacciBlockMaker(n),r=i.querySelector(".fibonacci-block__return-value"),t=i.querySelector(".fibonacci-block__function-name"),c.appendChild(i),!(2<n)){e.next=7;break}return void(e.next=7);case 7:if(a=0,1!=n&&2!=n){e.next=12;break}a=1,e.next=34;break;case 12:o=fib(n-1,i),u=o.next(),l=void 0;case 15:if(u.done){e.next=22;break}return l=u.value,void(e.next=19);case 19:u=o.next(),e.next=15;break;case 22:a+=l,s=fib(n-2,i),f=s.next(),b=void 0;case 26:if(f.done){e.next=33;break}return b=f.value,void(e.next=30);case 30:f=s.next(),e.next=26;break;case 33:a+=b;case 34:return r.innerHTML=a.toString(),r.classList.add("fibonacci-block__return-value--returned"),t.classList.add("fibonacci-block__function-name--resolved"),e.next=39,a;case 39:case"end":return e.stop()}},_marked,this)}function trial(e,n){setTimeout(function e(n,c){c&&c.done||(c=n.next(),setTimeout(e,300,n,c))},300,e,n)}fibonacciWrapper.scroll(4400,0);var fibGeneratorMaker=new FibonacciGeneratorMaker;trial(fibGeneratorMaker.fibonacci(7,fibonacciDemoContainer),null);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImZpYm9uYWNjaS5qcyJdLCJuYW1lcyI6WyJmaWIiLCJGaWJvbmFjY2lHZW5lcmF0b3JNYWtlciIsIl9jbGFzc0NhbGxDaGVjayIsInRoaXMiLCJyZXR1cm5WYWx1ZSIsIm51bWJlciIsInBhcmVudERPTVJlZiIsImZpYm9uYWNjaUJsb2NrIiwibWFrZUZpYm9ubmFjaUJsb2NrIiwicGxhY2VGaWJvbmFjY2lCbG9ja09uUGFnZSIsInZhbHVlIiwiZ2VuZXJhdGVGaWJvbmFjY2kiLCJnZW5lcmF0b3IiLCJmaWJvbmFjY2kiLCJuZXh0IiwiZG9uZSIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsImlubmVySFRNTCIsImZ1bmN0aW9uVmFsdWVUZXh0IiwicXVlcnlTZWxlY3RvciIsInRvU3RyaW5nIiwiY2xhc3NMaXN0IiwiYWRkIiwiZnVuY3Rpb25OYW1lQmxvY2siLCJzaG93RnVuY3Rpb25IYXNSZXNvbHZlZCIsIkRPTUxvY2F0aW9uIiwiYXBwZW5kQ2hpbGQiLCJmaWJvbmFjY2lCbG9ja01ha2VyIiwibiIsImZpYm9uYWNjaURlbW9Db250YWluZXIiLCJmaWJvbmFjY2lXcmFwcGVyIiwiUHJvbWlzZSIsInJlc29sdmUiLCJzZXRUaW1lb3V0IiwiaGFzQ2hpbGROb2RlcyIsImFwcGVuZCIsInRoZW4iLCJfcmVmIiwiX3JlZjIiLCJfc2xpY2VkVG9BcnJheSIsInZhbDEiLCJ2YWwyIiwiZ2VuZXJhdG9yMSIsIm5leHQxIiwieWllbGRlZFZhbHVlMSIsImdlbmVyYXRvcjIiLCJuZXh0MiIsInlpZWxkZWRWYWx1ZTIiLCJyZWdlbmVyYXRvclJ1bnRpbWUiLCJ3cmFwIiwiX2NvbnRleHQzIiwicHJldiIsInNjcm9sbCIsInN0b3AiLCJfbWFya2VkIiwic3RlcCIsImdlbmVyYXRlZE9iaiIsImZpYkdlbmVyYXRvck1ha2VyIiwidHJpYWwiXSwibWFwcGluZ3MiOiJBQUFBLDRzQkFvSVVBLHFIQWxJSkMsbUNBQ0YsU0FBQUEsSUFBY0MsZ0JBQUFDLEtBQUFGLEdB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LEtBQUEsR0FBQSxNQUFBLEtBQUEsR0EvQlltQixHQUFBQSxFQStCWixLQUFBLEdBQUEsT0E3QndFZCxFQUExRFosVUFBMERHLEVBQUFXLFdBQUFGLEVBQTFDQSxVQUEwQ0ksSUFBQSwyQ0FBQUMsRUFBdkJBLFVBQXVCRCxJQUFBLDRDQTZCeEU0QixFQUFBckMsS0FBQSxHQTVCUUosRUE0QlIsS0FBQSxHQUFBLElBQUEsTUFBQSxPQUFBeUMsRUFBQUcsU0FBQUMsUUFBQXBELE1BekJvQjhCLFNBQUFBLE1BQUFBLEVBQUFBLEdBREpDLFdBQUEsU0FBQXNCLEVBQUE1QyxFQUFBNkMsR0FHSEEsR0FKREEsRUFBQTFDLE9BT0kwQyxFQUFJL0MsRUFBUUcsT0FDUnFCLFdBQWlCTCxFQUFWLElBQWlCdEIsRUFBakJrRCxLQUFzQyxJQUFBN0MsRUFBN0M2QyxHQTlFUnJELGlCQUFBQSxPQUFBQSxLQUFBQSxHQTBKWixJQUFNc0Qsa0JBQW9CLElBQUl6RCx3QkEzRU4wRCxNQUFBRCxrQkFBQTdDLFVBQXlCNkIsRUFBQUEsd0JBQXpCIiwiZmlsZSI6ImZpYm9uYWNjaS5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XHJcblxyXG5jbGFzcyBGaWJvbmFjY2lHZW5lcmF0b3JNYWtlciB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICB0aGlzLnJldHVyblZhbHVlO1xyXG4gICAgfVxyXG5cclxuICAgICpmaWJvbmFjY2kobnVtYmVyLCBwYXJlbnRET01SZWYpIHtcclxuICAgICAgICBjb25zdCBmaWJvbmFjY2lCbG9jayA9IHRoaXMubWFrZUZpYm9ubmFjaUJsb2NrKG51bWJlcik7XHJcbiAgICAgICAgdGhpcy5wbGFjZUZpYm9uYWNjaUJsb2NrT25QYWdlKGZpYm9uYWNjaUJsb2NrLCBwYXJlbnRET01SZWYpO1xyXG4gICAgXHJcbiAgICAgICAgaWYgKG51bWJlciA+IDIpIHtcclxuICAgICAgICAgICAgeWllbGQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIGxldCB2YWx1ZSA9IDA7XHJcbiAgICAgICAgaWYgKG51bWJlciA9PSAxIHx8IG51bWJlciA9PSAyKSB7XHJcbiAgICAgICAgICAgIHZhbHVlID0gMTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB5aWVsZCAqdGhpcy5nZW5lcmF0ZUZpYm9uYWNjaShudW1iZXIgLSAxLCBmaWJvbmFjY2lCbG9jayk7XHJcbiAgICAgICAgICAgIHZhbHVlICs9IHRoaXMucmV0dXJuVmFsdWU7XHJcbiAgICAgICAgICAgIHlpZWxkICp0aGlzLmdlbmVyYXRlRmlib25hY2NpKG51bWJlciAtIDIsIGZpYm9uYWNjaUJsb2NrKTtcclxuICAgICAgICAgICAgdmFsdWUgKz0gdGhpcy5yZXR1cm5WYWx1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgdGhpcy5zaG93RnVuY3Rpb25IYXNSZXNvbHZlZCh2YWx1ZSwgZmlib25hY2NpQmxvY2spO1xyXG4gICAgICAgIHlpZWxkIHZhbHVlOyAgICBcclxuICAgIH1cclxuXHJcbiAgICAqZ2VuZXJhdGVGaWJvbmFjY2kobnVtYmVyLCBwYXJlbnRET01SZWYpIHtcclxuICAgICAgICBsZXQgZ2VuZXJhdG9yID0gdGhpcy5maWJvbmFjY2kobnVtYmVyLCBwYXJlbnRET01SZWYpO1xyXG4gICAgICAgIGxldCBuZXh0ID0gZ2VuZXJhdG9yLm5leHQoKTtcclxuICAgICAgICBsZXQgcmV0dXJuVmFsdWU7XHJcblxyXG4gICAgICAgIHdoaWxlICghbmV4dC5kb25lKSB7XHJcbiAgICAgICAgICAgIHJldHVyblZhbHVlID0gbmV4dC52YWx1ZTtcclxuICAgICAgICAgICAgeWllbGQ7XHJcbiAgICAgICAgICAgIG5leHQgPSBnZW5lcmF0b3IubmV4dCgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5yZXR1cm5WYWx1ZSA9IHJldHVyblZhbHVlO1xyXG4gICAgfVxyXG5cclxuICAgIG1ha2VGaWJvbm5hY2lCbG9jayhudW1iZXIpIHtcclxuICAgICAgICBsZXQgZmlib25hY2NpQmxvY2sgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICBmaWJvbmFjY2lCbG9jay5jbGFzc0xpc3QuYWRkKCdmaWJvbmFjY2ktYmxvY2tfX2NoaWxkJyk7XHJcblxyXG4gICAgICAgIGZpYm9uYWNjaUJsb2NrLmlubmVySFRNTCA9IGA8ZGl2IGNsYXNzPVwiZmlib25hY2NpLWJsb2NrXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cCBjbGFzcz1cImZpYm9uYWNjaS1ibG9ja19fZnVuY3Rpb24tbmFtZSBmaWJvbmFjY2ktYmxvY2tfX3RvcC1yb3dcIj5maWIoJHtudW1iZXJ9KTwvcD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxwIGNsYXNzPVwiZmlib25hY2NpLWJsb2NrX19yZXR1cm4tdmFsdWUgZmlib25hY2NpLWJsb2NrX19ib3R0b20tcm93XCI+d2FpdGluZzwvcD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+YFxyXG5cclxuICAgICAgICByZXR1cm4gZmlib25hY2NpQmxvY2s7XHJcbiAgICB9XHJcblxyXG4gICAgc2hvd0Z1bmN0aW9uSGFzUmVzb2x2ZWQocmV0dXJuVmFsdWUsIGZpYm9uYWNjaUJsb2NrKSB7XHJcbiAgICAgICAgY29uc3QgZnVuY3Rpb25WYWx1ZVRleHQgPSBmaWJvbmFjY2lCbG9jay5xdWVyeVNlbGVjdG9yKCcuZmlib25hY2NpLWJsb2NrX19yZXR1cm4tdmFsdWUnKTtcclxuICAgICAgICBjb25zdCBmdW5jdGlvbk5hbWVCbG9jayA9IGZpYm9uYWNjaUJsb2NrLnF1ZXJ5U2VsZWN0b3IoJy5maWJvbmFjY2ktYmxvY2tfX2Z1bmN0aW9uLW5hbWUnKTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb25WYWx1ZVRleHQuaW5uZXJIVE1MID0gcmV0dXJuVmFsdWUudG9TdHJpbmcoKTtcclxuICAgICAgICBmdW5jdGlvblZhbHVlVGV4dC5jbGFzc0xpc3QuYWRkKCdmaWJvbmFjY2ktYmxvY2tfX3JldHVybi12YWx1ZS0tcmV0dXJuZWQnKTtcclxuICAgICAgICBmdW5jdGlvbk5hbWVCbG9jay5jbGFzc0xpc3QuYWRkKCdmaWJvbmFjY2ktYmxvY2tfX2Z1bmN0aW9uLW5hbWUtLXJlc29sdmVkJyk7XHJcbiAgICB9XHJcblxyXG4gICAgcGxhY2VGaWJvbmFjY2lCbG9ja09uUGFnZShmaWJvbmFjY2lCbG9jaywgRE9NTG9jYXRpb24pIHtcclxuICAgICAgICBET01Mb2NhdGlvbi5hcHBlbmRDaGlsZChmaWJvbmFjY2lCbG9jayk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGZpYm9uYWNjaUJsb2NrTWFrZXIobikge1xyXG4gICAgbGV0IGZpYm9uYWNjaUJsb2NrID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICBmaWJvbmFjY2lCbG9jay5jbGFzc0xpc3QuYWRkKCdmaWJvbmFjY2ktYmxvY2tfX2NoaWxkJyk7XHJcblxyXG4gICAgaWYgKG4gPT0gMSB8fCBuID09IDIpIHtcclxuICAgICAgICBmaWJvbmFjY2lCbG9jay5pbm5lckhUTUwgPSBgPGRpdiBjbGFzcz1cImZpYm9uYWNjaS1ibG9ja1wiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHAgY2xhc3M9XCJmaWJvbmFjY2ktYmxvY2tfX2Z1bmN0aW9uLW5hbWUgZmlib25hY2NpLWJsb2NrX19mdW5jdGlvbi1uYW1lLS1yZXNvbHZlZCBmaWJvbmFjY2ktYmxvY2tfX3RvcC1yb3dcIj5maWIoJHtufSk8L3A+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cCBjbGFzcz1cImZpYm9uYWNjaS1ibG9ja19fcmV0dXJuLXZhbHVlIGZpYm9uYWNjaS1ibG9ja19fcmV0dXJuLXZhbHVlLS1yZXR1cm5lZCBmaWJvbmFjY2ktYmxvY2tfX2JvdHRvbS1yb3dcIj4xPC9wPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5gXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIGZpYm9uYWNjaUJsb2NrLmlubmVySFRNTCA9IGA8ZGl2IGNsYXNzPVwiZmlib25hY2NpLWJsb2NrXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cCBjbGFzcz1cImZpYm9uYWNjaS1ibG9ja19fZnVuY3Rpb24tbmFtZSBmaWJvbmFjY2ktYmxvY2tfX3RvcC1yb3dcIj5maWIoJHtufSk8L3A+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cCBjbGFzcz1cImZpYm9uYWNjaS1ibG9ja19fcmV0dXJuLXZhbHVlIGZpYm9uYWNjaS1ibG9ja19fYm90dG9tLXJvd1wiPndhaXRpbmc8L3A+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PmBcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gZmlib25hY2NpQmxvY2s7XHJcbn1cclxuXHJcbmNvbnN0IGZpYm9uYWNjaURlbW9Db250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZmlib25hY2NpLWRlbW8nKTtcclxuY29uc3QgZmlib25hY2NpV3JhcHBlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5maWJvbmFjY2ktd3JhcHBlcicpO1xyXG5maWJvbmFjY2lXcmFwcGVyLnNjcm9sbCg0NDAwLCAwKTtcclxuXHJcbmZ1bmN0aW9uIGZpYm9uYWNjaShuLCBwYXJlbnRET01SZWYpIHtcclxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4ge1xyXG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICBsZXQgZmlib25hY2NpQmxvY2s7XHJcbiAgICAgICAgICAgIGlmICghZmlib25hY2NpRGVtb0NvbnRhaW5lci5oYXNDaGlsZE5vZGVzKCkpIGZpYm9uYWNjaUJsb2NrID0gZmlib25hY2NpQmxvY2tNYWtlcihuLCB0cnVlKTtcclxuICAgICAgICAgICAgZWxzZSBmaWJvbmFjY2lCbG9jayA9IGZpYm9uYWNjaUJsb2NrTWFrZXIobiwgZmFsc2UpO1xyXG4gICAgICAgICAgICBsZXQgZnVuY3Rpb25WYWx1ZVRleHQgPSBmaWJvbmFjY2lCbG9jay5xdWVyeVNlbGVjdG9yKCcuZmlib25hY2NpLWJsb2NrX19yZXR1cm4tdmFsdWUnKTtcclxuICAgICAgICAgICAgbGV0IGZ1bmN0aW9uTmFtZUJsb2NrID0gZmlib25hY2NpQmxvY2sucXVlcnlTZWxlY3RvcignLmZpYm9uYWNjaS1ibG9ja19fZnVuY3Rpb24tbmFtZScpO1xyXG4gICAgICAgICAgICBwYXJlbnRET01SZWYuYXBwZW5kKGZpYm9uYWNjaUJsb2NrKTtcclxuICAgICAgICAgICAgcmVzb2x2ZShbZmlib25hY2NpQmxvY2ssIGZ1bmN0aW9uVmFsdWVUZXh0LCBmdW5jdGlvbk5hbWVCbG9ja10pO1xyXG4gICAgICAgIH0sIDUwMCk7XHJcbiAgICB9KS50aGVuKChbZmlib25hY2NpQmxvY2ssIGZ1bmN0aW9uVmFsdWVUZXh0LCBmdW5jdGlvbk5hbWVCbG9ja10pID0+IHtcclxuICAgICAgICBpZiAobiA9PSAxIHx8IG4gPT0gMikge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcclxuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoMSk7XHJcbiAgICAgICAgICAgICAgICB9LCA1MDApO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcclxuICAgICAgICAgICAgICAgIGxldCB2YWx1ZSA9IGZpYm9uYWNjaShuIC0gMSwgZmlib25hY2NpQmxvY2spLnRoZW4oKHZhbDEpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmlib25hY2NpKG4gLSAyLCBmaWJvbmFjY2lCbG9jaykudGhlbigodmFsMikgPT4gW3ZhbDEsIHZhbDJdKTtcclxuICAgICAgICAgICAgICAgIH0pLnRoZW4oKFt2YWwxLCB2YWwyXSkgPT4gdmFsMSArIHZhbDIpO1xyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZSh2YWx1ZSk7XHJcbiAgICAgICAgICAgIH0pLnRoZW4oKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb25WYWx1ZVRleHQuaW5uZXJIVE1MID0gdmFsdWUudG9TdHJpbmcoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb25WYWx1ZVRleHQuY2xhc3NMaXN0LmFkZCgnZmlib25hY2NpLWJsb2NrX19yZXR1cm4tdmFsdWUtLXJldHVybmVkJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uTmFtZUJsb2NrLmNsYXNzTGlzdC5hZGQoJ2ZpYm9uYWNjaS1ibG9ja19fZnVuY3Rpb24tbmFtZS0tcmVzb2x2ZWQnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSh2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSwgNTAwKTtcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfVxyXG4gICAgfSlcclxufVxyXG5cclxuLy8gZmlib25hY2NpKDcsIGZpYm9uYWNjaURlbW9Db250YWluZXIpXHJcblxyXG5mdW5jdGlvbiogZmliKG51bWJlciwgcGFyZW50RE9NUmVmKSB7XHJcbiAgICBjb25zdCBmaWJvbmFjY2lCbG9jayA9IGZpYm9uYWNjaUJsb2NrTWFrZXIobnVtYmVyKTtcclxuICAgIGNvbnN0IGZ1bmN0aW9uVmFsdWVUZXh0ID0gZmlib25hY2NpQmxvY2sucXVlcnlTZWxlY3RvcignLmZpYm9uYWNjaS1ibG9ja19fcmV0dXJuLXZhbHVlJyk7XHJcbiAgICBjb25zdCBmdW5jdGlvbk5hbWVCbG9jayA9IGZpYm9uYWNjaUJsb2NrLnF1ZXJ5U2VsZWN0b3IoJy5maWJvbmFjY2ktYmxvY2tfX2Z1bmN0aW9uLW5hbWUnKTtcclxuICAgIHBhcmVudERPTVJlZi5hcHBlbmRDaGlsZChmaWJvbmFjY2lCbG9jayk7XHJcblxyXG4gICAgaWYgKG51bWJlciA+IDIpIHtcclxuICAgICAgICB5aWVsZDtcclxuICAgIH1cclxuICAgIFxyXG5cclxuICAgIGxldCB2YWx1ZSA9IDA7XHJcbiAgICBpZiAobnVtYmVyID09IDEgfHwgbnVtYmVyID09IDIpIHtcclxuICAgICAgICB2YWx1ZSA9IDE7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIGxldCBnZW5lcmF0b3IxID0gZmliKG51bWJlciAtIDEsIGZpYm9uYWNjaUJsb2NrKTtcclxuICAgICAgICBsZXQgbmV4dDEgPSBnZW5lcmF0b3IxLm5leHQoKTtcclxuICAgICAgICBsZXQgeWllbGRlZFZhbHVlMTtcclxuICAgICAgICB3aGlsZSAoIW5leHQxLmRvbmUpIHtcclxuICAgICAgICAgICAgeWllbGRlZFZhbHVlMSA9IG5leHQxLnZhbHVlO1xyXG4gICAgICAgICAgICB5aWVsZDtcclxuICAgICAgICAgICAgbmV4dDEgPSBnZW5lcmF0b3IxLm5leHQoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFsdWUgKz0geWllbGRlZFZhbHVlMTtcclxuXHJcbiAgICAgICAgbGV0IGdlbmVyYXRvcjIgPSBmaWIobnVtYmVyIC0gMiwgZmlib25hY2NpQmxvY2spO1xyXG4gICAgICAgIGxldCBuZXh0MiA9IGdlbmVyYXRvcjIubmV4dCgpO1xyXG4gICAgICAgIGxldCB5aWVsZGVkVmFsdWUyO1xyXG4gICAgICAgIHdoaWxlICghbmV4dDIuZG9uZSkge1xyXG4gICAgICAgICAgICB5aWVsZGVkVmFsdWUyID0gbmV4dDIudmFsdWU7XHJcbiAgICAgICAgICAgIHlpZWxkO1xyXG4gICAgICAgICAgICBuZXh0MiA9IGdlbmVyYXRvcjIubmV4dCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YWx1ZSArPSB5aWVsZGVkVmFsdWUyO1xyXG4gICAgfVxyXG4gICAgXHJcblxyXG4gICAgZnVuY3Rpb25WYWx1ZVRleHQuaW5uZXJIVE1MID0gdmFsdWUudG9TdHJpbmcoKTtcclxuICAgIGZ1bmN0aW9uVmFsdWVUZXh0LmNsYXNzTGlzdC5hZGQoJ2ZpYm9uYWNjaS1ibG9ja19fcmV0dXJuLXZhbHVlLS1yZXR1cm5lZCcpO1xyXG4gICAgZnVuY3Rpb25OYW1lQmxvY2suY2xhc3NMaXN0LmFkZCgnZmlib25hY2NpLWJsb2NrX19mdW5jdGlvbi1uYW1lLS1yZXNvbHZlZCcpO1xyXG4gICAgXHJcbiAgICB5aWVsZCB2YWx1ZTsgICAgXHJcbn1cclxuXHJcbmZ1bmN0aW9uIHRyaWFsKGdlbmVyYXRvciwgZ2VuZXJhdGVkT2JqKSB7XHJcbiAgICBsZXQgY29kZVN0ZXBwZXIgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uIHN0ZXAoZ2VuZXJhdG9yLCBnZW5lcmF0ZWRPYmopIHtcclxuICAgICAgICBpZiAoZ2VuZXJhdGVkT2JqICYmIGdlbmVyYXRlZE9iai5kb25lKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBnZW5lcmF0ZWRPYmogPSBnZW5lcmF0b3IubmV4dCgpO1xyXG4gICAgICAgICAgICBjb2RlU3RlcHBlciA9IHNldFRpbWVvdXQoc3RlcCwgMzAwLCBnZW5lcmF0b3IsIGdlbmVyYXRlZE9iaik7XHJcbiAgICAgICAgfVxyXG4gICAgfSwgMzAwLCBnZW5lcmF0b3IsIGdlbmVyYXRlZE9iaik7XHJcbn1cclxuXHJcbi8vIHRyaWFsKGZpYigxMCwgZmlib25hY2NpRGVtb0NvbnRhaW5lciksIG51bGwpO1xyXG5cclxuY29uc3QgZmliR2VuZXJhdG9yTWFrZXIgPSBuZXcgRmlib25hY2NpR2VuZXJhdG9yTWFrZXIoKTtcclxudHJpYWwoZmliR2VuZXJhdG9yTWFrZXIuZmlib25hY2NpKDcsIGZpYm9uYWNjaURlbW9Db250YWluZXIpLCBudWxsKTsiXX0=
