"use strict";var _slicedToArray=function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,n){var c=[],i=!0,t=!1,r=void 0;try{for(var a,o=e[Symbol.iterator]();!(i=(a=o.next()).done)&&(c.push(a.value),!n||c.length!==n);i=!0);}catch(e){t=!0,r=e}finally{try{!i&&o.return&&o.return()}finally{if(t)throw r}}return c}(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")},_createClass=function(){function i(e,n){for(var c=0;c<n.length;c++){var i=n[c];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,n,c){return n&&i(e.prototype,n),c&&i(e,c),e}}(),_marked=regeneratorRuntime.mark(fib);function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}var FibonacciGeneratorMaker=function(){function e(){_classCallCheck(this,e),this.returnValue}return _createClass(e,[{key:"fibonacci",value:regeneratorRuntime.mark(function e(n,c){var i,t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.makeFibonnaciBlock(n),this.placeFibonacciBlockOnPage(i,c),!(2<n)){e.next=5;break}return void(e.next=5);case 5:if(t=0,1!=n&&2!=n){e.next=10;break}t=1,e.next=14;break;case 10:return e.delegateYield(this.generateFibonacci(n-1,i),"t0",11);case 11:return t+=this.returnValue,e.delegateYield(this.generateFibonacci(n-2,i),"t1",13);case 13:t+=this.returnValue;case 14:return this.showFunctionHasResolved(t,i),e.next=17,t;case 17:case"end":return e.stop()}},e,this)})},{key:"generateFibonacci",value:regeneratorRuntime.mark(function e(n,c){var i,t,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:i=this.fibonacci(n,c),t=i.next(),r=void 0;case 3:if(t.done){e.next=10;break}return r=t.value,void(e.next=7);case 7:t=i.next(),e.next=3;break;case 10:this.returnValue=r;case 11:case"end":return e.stop()}},e,this)})},{key:"makeFibonnaciBlock",value:function(e){var n=document.createElement("div");return n.classList.add("fibonacci-block__child"),n.innerHTML='<div class="fibonacci-block">\n                                        <p class="fibonacci-block__function-name fibonacci-block__top-row">fib('+e+')</p>\n                                        <p class="fibonacci-block__return-value fibonacci-block__bottom-row">waiting</p>\n                                    </div>',n}},{key:"showFunctionHasResolved",value:function(e,n){var c=n.querySelector(".fibonacci-block__return-value"),i=n.querySelector(".fibonacci-block__function-name");c.innerHTML=e.toString(),c.classList.add("fibonacci-block__return-value--returned"),i.classList.add("fibonacci-block__function-name--resolved")}},{key:"placeFibonacciBlockOnPage",value:function(e,n){n.appendChild(e)}}]),e}();function fibonacciBlockMaker(e){var n=document.createElement("div");return n.classList.add("fibonacci-block__child"),n.innerHTML=1==e||2==e?'<div class="fibonacci-block">\n                                        <p class="fibonacci-block__function-name fibonacci-block__function-name--resolved fibonacci-block__top-row">fib('+e+')</p>\n                                        <p class="fibonacci-block__return-value fibonacci-block__return-value--returned fibonacci-block__bottom-row">1</p>\n                                    </div>':'<div class="fibonacci-block">\n                                        <p class="fibonacci-block__function-name fibonacci-block__top-row">fib('+e+')</p>\n                                        <p class="fibonacci-block__return-value fibonacci-block__bottom-row">waiting</p>\n                                    </div>',n}var fibonacciDemoContainer=document.querySelector(".fibonacci-demo"),fibonacciWrapper=document.querySelector(".fibonacci-wrapper");function fibonacci(r,t){return new Promise(function(i){setTimeout(function(){var e=void 0,n=(e=fibonacciDemoContainer.hasChildNodes()?fibonacciBlockMaker(r,!1):fibonacciBlockMaker(r,!0)).querySelector(".fibonacci-block__return-value"),c=e.querySelector(".fibonacci-block__function-name");t.append(e),i([e,n,c])},500)}).then(function(e){var n=_slicedToArray(e,3),c=n[0],i=n[1],t=n[2];return 1==r||2==r?new Promise(function(e){setTimeout(function(){e(1)},500)}):new Promise(function(e){e(fibonacci(r-1,c).then(function(n){return fibonacci(r-2,c).then(function(e){return[n,e]})}).then(function(e){var n=_slicedToArray(e,2);return n[0]+n[1]}))}).then(function(n){return new Promise(function(e){setTimeout(function(){i.innerHTML=n.toString(),i.classList.add("fibonacci-block__return-value--returned"),t.classList.add("fibonacci-block__function-name--resolved"),e(n)},500)})})})}function fib(n,c){var i,t,r,a,o,l,u,s,b,f;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=fibonacciBlockMaker(n),t=i.querySelector(".fibonacci-block__return-value"),r=i.querySelector(".fibonacci-block__function-name"),c.appendChild(i),!(2<n)){e.next=7;break}return void(e.next=7);case 7:if(a=0,1!=n&&2!=n){e.next=12;break}a=1,e.next=34;break;case 12:o=fib(n-1,i),l=o.next(),u=void 0;case 15:if(l.done){e.next=22;break}return u=l.value,void(e.next=19);case 19:l=o.next(),e.next=15;break;case 22:a+=u,s=fib(n-2,i),b=s.next(),f=void 0;case 26:if(b.done){e.next=33;break}return f=b.value,void(e.next=30);case 30:b=s.next(),e.next=26;break;case 33:a+=f;case 34:return t.innerHTML=a.toString(),t.classList.add("fibonacci-block__return-value--returned"),r.classList.add("fibonacci-block__function-name--resolved"),e.next=39,a;case 39:case"end":return e.stop()}},_marked,this)}function trial(e,n){setTimeout(function e(n,c){c&&c.done||(c=n.next(),setTimeout(e,300,n,c))},300,e,n)}var fibGeneratorMaker=new FibonacciGeneratorMaker,simulationController=document.querySelector(".simulation-controller"),startButton=document.querySelector(".simulation-controller__start-button"),simulationFunctionParameter=document.querySelector(".simulation-controller__function-parameter"),simulationDelay=document.querySelector(".simulation-controller__delay"),codePlayer=new CodePlayer(fibGeneratorMaker.fibonacci.bind(fibGeneratorMaker),simulationController,"fibonacci-demo");codePlayer.placeCodePlayerAtLocation(fibonacciWrapper),codePlayer.simluationStartButton.addEventListener("click",codePlayer.startFunction),codePlayer.simulationPlayPause.addEventListener("click",codePlayer.togglePlayPause),codePlayer.simulationPlayPause.addEventListener("click",codePlayer.playFunction),codePlayer.simulationStepper.addEventListener("click",codePlayer.step),fibonacciWrapper.scroll(4400,0);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImZpYm9uYWNjaS5qcyJdLCJuYW1lcyI6WyJmaWIiLCJGaWJvbmFjY2lHZW5lcmF0b3JNYWtlciIsIl9jbGFzc0NhbGxDaGVjayIsInRoaXMiLCJyZXR1cm5WYWx1ZSIsIm51bWJlciIsInBhcmVudERPTVJlZiIsImZpYm9uYWNjaUJsb2NrIiwibWFrZUZpYm9ubmFjaUJsb2NrIiwicGxhY2VGaWJvbmFjY2lCbG9ja09uUGFnZSIsInZhbHVlIiwiZ2VuZXJhdGVGaWJvbmFjY2kiLCJnZW5lcmF0b3IiLCJmaWJvbmFjY2kiLCJuZXh0IiwiZG9uZSIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsImlubmVySFRNTCIsImZ1bmN0aW9uVmFsdWVUZXh0IiwicXVlcnlTZWxlY3RvciIsInRvU3RyaW5nIiwiY2xhc3NMaXN0IiwiYWRkIiwiZnVuY3Rpb25OYW1lQmxvY2siLCJzaG93RnVuY3Rpb25IYXNSZXNvbHZlZCIsIkRPTUxvY2F0aW9uIiwiYXBwZW5kQ2hpbGQiLCJmaWJvbmFjY2lCbG9ja01ha2VyIiwibiIsImZpYm9uYWNjaURlbW9Db250YWluZXIiLCJmaWJvbmFjY2lXcmFwcGVyIiwiUHJvbWlzZSIsInJlc29sdmUiLCJzZXRUaW1lb3V0IiwiaGFzQ2hpbGROb2RlcyIsImFwcGVuZCIsInRoZW4iLCJfcmVmIiwiX3JlZjIiLCJfc2xpY2VkVG9BcnJheSIsInZhbDEiLCJ2YWwyIiwiZ2VuZXJhdG9yMSIsIm5leHQxIiwieWllbGRlZFZhbHVlMSIsImdlbmVyYXRvcjIiLCJuZXh0MiIsInlpZWxkZWRWYWx1ZTIiLCJyZWdlbmVyYXRvclJ1bnRpbWUiLCJ3cmFwIiwiX2NvbnRleHQzIiwicHJldiIsInN0b3AiLCJfbWFya2VkIiwidHJpYWwiLCJnZW5lcmF0b3JZaWVsZCIsInN0ZXAiLCJmaWJHZW5lcmF0b3JNYWtlciIsInNpbXVsYXRpb25Db250cm9sbGVyIiwic3RhcnRCdXR0b24iLCJiaW5kIiwiY29kZVBsYXllciIsInNpbWx1YXRpb25TdGFydEJ1dHRvbiIsImFkZEV2ZW50TGlzdGVuZXIiLCJzdGFydEZ1bmN0aW9uIiwic2ltdWxhdGlvblBsYXlQYXVzZSIsInRvZ2dsZVBsYXlQYXVzZSIsInBsYXlGdW5jdGlvbiIsInNpbXVsYXRpb25TdGVwcGVyIiwic2Nyb2xsIl0sIm1hcHBpbmdzIjoiQUFDQSw0c0JBb0lVQSxxSEFsSUpDLG1DQUNGLFNBQUFBLElBQWNDLGdCQUFBQyxLQUFBRixHQUNWRSxLQUFLQyw2RkFHRUMsRUFBUUMsNkZBQ1RDLEVBQWlCSixLQUFLSyxtQkFBbUJILEdBQy9DRixLQUFLTSwwQkFBMEJGLEVBQWdCRCxLQU5uRCxFQUFBRCxtREFFQ0ssRUFBQSxFQVdpQixHQUFWTCxHQUF5QixHQUFWQSxtQkFDZkssRUFBUSxpREFFRFAsS0FBS1Esa0JBQWtCTixFQUFTLEVBQUdFLDJCQUMxQ0csR0FBU1AsS0FBS0MsNEJBQ1BELEtBQUtRLGtCQUFrQk4sRUFBUyxFQUFHRSxvQkFDMUNHLEdBQVNQLEtBQUtDLDJCQWRaRyxLQUFBQSx3QkFBQUEsRUFpQjhCQSxhQUM5QkcsbUhBR1NMLEVBQVFDLDRGQUNuQk0sRUFBWVQsS0FBS1UsVUFBVVIsRUFBUUMsR0FDbkNRLEVBQU9GLEVBQVVFLE9BQ2pCVixtQkFFSVUsRUFBS0MsNkJBQ1RYLEVBQWNVLEVBQUtKLDRCQUVuQkksRUFBT0YsRUFBVUUsOEJBR3JCWCxLQUFLQyxZQUFjQSwwRkFHSkMsR0FDZixJQUFJRSxFQUFpQlMsU0FBU0MsY0FBYyxPQVE1QyxPQW5DSVAsRUFBQUEsVUFBQUEsSUFBQSwwQkE4QkpILEVBQWVXLFVBQWYsaUpBQ3lHYixFQUR6Ryw4S0FLT0Usa0RBR2FILEVBQWFHLEdBQ2pDLElBQU1ZLEVBQW9CWixFQUFlYSxjQUFjLGtDQWxDbkRWLEVBQUFBLEVBQWNOLGNBQWQsbUNBcUNKZSxFQUFrQkQsVUFBWWQsRUFBWWlCLFdBQzFDRixFQUFrQkcsVUFBVUMsSUFBSSwyQ0FuQ2hDQyxFQUFBRixVQUFLRyxJQUFBQSw4RkF1Q2lCbEIsRUFBZ0JtQixHQUN0Q0EsRUFBWUMs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a0JBQUFMLGlCQUFBLFFBQUFGLFdBQUFMLE1BZ0hKMUIsaUJBQWlCdUMsT0FBTyxLQUFNIiwiZmlsZSI6ImZpYm9uYWNjaS5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vY29kZV9wbGF5ZXIvY29kZS1wbGF5ZXIuanNcIiAvPlxyXG4ndXNlIHN0cmljdCc7XHJcblxyXG5jbGFzcyBGaWJvbmFjY2lHZW5lcmF0b3JNYWtlciB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICB0aGlzLnJldHVyblZhbHVlO1xyXG4gICAgfVxyXG5cclxuICAgICpmaWJvbmFjY2kobnVtYmVyLCBwYXJlbnRET01SZWYpIHtcclxuICAgICAgICBjb25zdCBmaWJvbmFjY2lCbG9jayA9IHRoaXMubWFrZUZpYm9ubmFjaUJsb2NrKG51bWJlcik7XHJcbiAgICAgICAgdGhpcy5wbGFjZUZpYm9uYWNjaUJsb2NrT25QYWdlKGZpYm9uYWNjaUJsb2NrLCBwYXJlbnRET01SZWYpO1xyXG4gICAgXHJcbiAgICAgICAgaWYgKG51bWJlciA+IDIpIHtcclxuICAgICAgICAgICAgeWllbGQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIGxldCB2YWx1ZSA9IDA7XHJcbiAgICAgICAgaWYgKG51bWJlciA9PSAxIHx8IG51bWJlciA9PSAyKSB7XHJcbiAgICAgICAgICAgIHZhbHVlID0gMTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB5aWVsZCogdGhpcy5nZW5lcmF0ZUZpYm9uYWNjaShudW1iZXIgLSAxLCBmaWJvbmFjY2lCbG9jayk7XHJcbiAgICAgICAgICAgIHZhbHVlICs9IHRoaXMucmV0dXJuVmFsdWU7XHJcbiAgICAgICAgICAgIHlpZWxkKiB0aGlzLmdlbmVyYXRlRmlib25hY2NpKG51bWJlciAtIDIsIGZpYm9uYWNjaUJsb2NrKTtcclxuICAgICAgICAgICAgdmFsdWUgKz0gdGhpcy5yZXR1cm5WYWx1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgdGhpcy5zaG93RnVuY3Rpb25IYXNSZXNvbHZlZCh2YWx1ZSwgZmlib25hY2NpQmxvY2spO1xyXG4gICAgICAgIHlpZWxkIHZhbHVlOyAgICBcclxuICAgIH1cclxuXHJcbiAgICAqZ2VuZXJhdGVGaWJvbmFjY2kobnVtYmVyLCBwYXJlbnRET01SZWYpIHtcclxuICAgICAgICBsZXQgZ2VuZXJhdG9yID0gdGhpcy5maWJvbmFjY2kobnVtYmVyLCBwYXJlbnRET01SZWYpO1xyXG4gICAgICAgIGxldCBuZXh0ID0gZ2VuZXJhdG9yLm5leHQoKTtcclxuICAgICAgICBsZXQgcmV0dXJuVmFsdWU7XHJcblxyXG4gICAgICAgIHdoaWxlICghbmV4dC5kb25lKSB7XHJcbiAgICAgICAgICAgIHJldHVyblZhbHVlID0gbmV4dC52YWx1ZTtcclxuICAgICAgICAgICAgeWllbGQ7XHJcbiAgICAgICAgICAgIG5leHQgPSBnZW5lcmF0b3IubmV4dCgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5yZXR1cm5WYWx1ZSA9IHJldHVyblZhbHVlO1xyXG4gICAgfVxyXG5cclxuICAgIG1ha2VGaWJvbm5hY2lCbG9jayhudW1iZXIpIHtcclxuICAgICAgICBsZXQgZmlib25hY2NpQmxvY2sgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICBmaWJvbmFjY2lCbG9jay5jbGFzc0xpc3QuYWRkKCdmaWJvbmFjY2ktYmxvY2tfX2NoaWxkJyk7XHJcblxyXG4gICAgICAgIGZpYm9uYWNjaUJsb2NrLmlubmVySFRNTCA9IGA8ZGl2IGNsYXNzPVwiZmlib25hY2NpLWJsb2NrXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cCBjbGFzcz1cImZpYm9uYWNjaS1ibG9ja19fZnVuY3Rpb24tbmFtZSBmaWJvbmFjY2ktYmxvY2tfX3RvcC1yb3dcIj5maWIoJHtudW1iZXJ9KTwvcD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxwIGNsYXNzPVwiZmlib25hY2NpLWJsb2NrX19yZXR1cm4tdmFsdWUgZmlib25hY2NpLWJsb2NrX19ib3R0b20tcm93XCI+d2FpdGluZzwvcD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+YFxyXG5cclxuICAgICAgICByZXR1cm4gZmlib25hY2NpQmxvY2s7XHJcbiAgICB9XHJcblxyXG4gICAgc2hvd0Z1bmN0aW9uSGFzUmVzb2x2ZWQocmV0dXJuVmFsdWUsIGZpYm9uYWNjaUJsb2NrKSB7XHJcbiAgICAgICAgY29uc3QgZnVuY3Rpb25WYWx1ZVRleHQgPSBmaWJvbmFjY2lCbG9jay5xdWVyeVNlbGVjdG9yKCcuZmlib25hY2NpLWJsb2NrX19yZXR1cm4tdmFsdWUnKTtcclxuICAgICAgICBjb25zdCBmdW5jdGlvbk5hbWVCbG9jayA9IGZpYm9uYWNjaUJsb2NrLnF1ZXJ5U2VsZWN0b3IoJy5maWJvbmFjY2ktYmxvY2tfX2Z1bmN0aW9uLW5hbWUnKTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb25WYWx1ZVRleHQuaW5uZXJIVE1MID0gcmV0dXJuVmFsdWUudG9TdHJpbmcoKTtcclxuICAgICAgICBmdW5jdGlvblZhbHVlVGV4dC5jbGFzc0xpc3QuYWRkKCdmaWJvbmFjY2ktYmxvY2tfX3JldHVybi12YWx1ZS0tcmV0dXJuZWQnKTtcclxuICAgICAgICBmdW5jdGlvbk5hbWVCbG9jay5jbGFzc0xpc3QuYWRkKCdmaWJvbmFjY2ktYmxvY2tfX2Z1bmN0aW9uLW5hbWUtLXJlc29sdmVkJyk7XHJcbiAgICB9XHJcblxyXG4gICAgcGxhY2VGaWJvbmFjY2lCbG9ja09uUGFnZShmaWJvbmFjY2lCbG9jaywgRE9NTG9jYXRpb24pIHtcclxuICAgICAgICBET01Mb2NhdGlvbi5hcHBlbmRDaGlsZChmaWJvbmFjY2lCbG9jayk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGZpYm9uYWNjaUJsb2NrTWFrZXIobikge1xyXG4gICAgbGV0IGZpYm9uYWNjaUJsb2NrID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICBmaWJvbmFjY2lCbG9jay5jbGFzc0xpc3QuYWRkKCdmaWJvbmFjY2ktYmxvY2tfX2NoaWxkJyk7XHJcblxyXG4gICAgaWYgKG4gPT0gMSB8fCBuID09IDIpIHtcclxuICAgICAgICBmaWJvbmFjY2lCbG9jay5pbm5lckhUTUwgPSBgPGRpdiBjbGFzcz1cImZpYm9uYWNjaS1ibG9ja1wiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHAgY2xhc3M9XCJmaWJvbmFjY2ktYmxvY2tfX2Z1bmN0aW9uLW5hbWUgZmlib25hY2NpLWJsb2NrX19mdW5jdGlvbi1uYW1lLS1yZXNvbHZlZCBmaWJvbmFjY2ktYmxvY2tfX3RvcC1yb3dcIj5maWIoJHtufSk8L3A+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cCBjbGFzcz1cImZpYm9uYWNjaS1ibG9ja19fcmV0dXJuLXZhbHVlIGZpYm9uYWNjaS1ibG9ja19fcmV0dXJuLXZhbHVlLS1yZXR1cm5lZCBmaWJvbmFjY2ktYmxvY2tfX2JvdHRvbS1yb3dcIj4xPC9wPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5gXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIGZpYm9uYWNjaUJsb2NrLmlubmVySFRNTCA9IGA8ZGl2IGNsYXNzPVwiZmlib25hY2NpLWJsb2NrXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cCBjbGFzcz1cImZpYm9uYWNjaS1ibG9ja19fZnVuY3Rpb24tbmFtZSBmaWJvbmFjY2ktYmxvY2tfX3RvcC1yb3dcIj5maWIoJHtufSk8L3A+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cCBjbGFzcz1cImZpYm9uYWNjaS1ibG9ja19fcmV0dXJuLXZhbHVlIGZpYm9uYWNjaS1ibG9ja19fYm90dG9tLXJvd1wiPndhaXRpbmc8L3A+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PmBcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gZmlib25hY2NpQmxvY2s7XHJcbn1cclxuXHJcbmNvbnN0IGZpYm9uYWNjaURlbW9Db250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZmlib25hY2NpLWRlbW8nKTtcclxuY29uc3QgZmlib25hY2NpV3JhcHBlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5maWJvbmFjY2ktd3JhcHBlcicpO1xyXG5cclxuXHJcbmZ1bmN0aW9uIGZpYm9uYWNjaShuLCBwYXJlbnRET01SZWYpIHtcclxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4ge1xyXG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICBsZXQgZmlib25hY2NpQmxvY2s7XHJcbiAgICAgICAgICAgIGlmICghZmlib25hY2NpRGVtb0NvbnRhaW5lci5oYXNDaGlsZE5vZGVzKCkpIGZpYm9uYWNjaUJsb2NrID0gZmlib25hY2NpQmxvY2tNYWtlcihuLCB0cnVlKTtcclxuICAgICAgICAgICAgZWxzZSBmaWJvbmFjY2lCbG9jayA9IGZpYm9uYWNjaUJsb2NrTWFrZXIobiwgZmFsc2UpO1xyXG4gICAgICAgICAgICBsZXQgZnVuY3Rpb25WYWx1ZVRleHQgPSBmaWJvbmFjY2lCbG9jay5xdWVyeVNlbGVjdG9yKCcuZmlib25hY2NpLWJsb2NrX19yZXR1cm4tdmFsdWUnKTtcclxuICAgICAgICAgICAgbGV0IGZ1bmN0aW9uTmFtZUJsb2NrID0gZmlib25hY2NpQmxvY2sucXVlcnlTZWxlY3RvcignLmZpYm9uYWNjaS1ibG9ja19fZnVuY3Rpb24tbmFtZScpO1xyXG4gICAgICAgICAgICBwYXJlbnRET01SZWYuYXBwZW5kKGZpYm9uYWNjaUJsb2NrKTtcclxuICAgICAgICAgICAgcmVzb2x2ZShbZmlib25hY2NpQmxvY2ssIGZ1bmN0aW9uVmFsdWVUZXh0LCBmdW5jdGlvbk5hbWVCbG9ja10pO1xyXG4gICAgICAgIH0sIDUwMCk7XHJcbiAgICB9KS50aGVuKChbZmlib25hY2NpQmxvY2ssIGZ1bmN0aW9uVmFsdWVUZXh0LCBmdW5jdGlvbk5hbWVCbG9ja10pID0+IHtcclxuICAgICAgICBpZiAobiA9PSAxIHx8IG4gPT0gMikge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcclxuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoMSk7XHJcbiAgICAgICAgICAgICAgICB9LCA1MDApO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcclxuICAgICAgICAgICAgICAgIGxldCB2YWx1ZSA9IGZpYm9uYWNjaShuIC0gMSwgZmlib25hY2NpQmxvY2spLnRoZW4oKHZhbDEpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmlib25hY2NpKG4gLSAyLCBmaWJvbmFjY2lCbG9jaykudGhlbigodmFsMikgPT4gW3ZhbDEsIHZhbDJdKTtcclxuICAgICAgICAgICAgICAgIH0pLnRoZW4oKFt2YWwxLCB2YWwyXSkgPT4gdmFsMSArIHZhbDIpO1xyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZSh2YWx1ZSk7XHJcbiAgICAgICAgICAgIH0pLnRoZW4oKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb25WYWx1ZVRleHQuaW5uZXJIVE1MID0gdmFsdWUudG9TdHJpbmcoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb25WYWx1ZVRleHQuY2xhc3NMaXN0LmFkZCgnZmlib25hY2NpLWJsb2NrX19yZXR1cm4tdmFsdWUtLXJldHVybmVkJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uTmFtZUJsb2NrLmNsYXNzTGlzdC5hZGQoJ2ZpYm9uYWNjaS1ibG9ja19fZnVuY3Rpb24tbmFtZS0tcmVzb2x2ZWQnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSh2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSwgNTAwKTtcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfVxyXG4gICAgfSlcclxufVxyXG5cclxuLy8gZmlib25hY2NpKDcsIGZpYm9uYWNjaURlbW9Db250YWluZXIpXHJcblxyXG5mdW5jdGlvbiogZmliKG51bWJlciwgcGFyZW50RE9NUmVmKSB7XHJcbiAgICBjb25zdCBmaWJvbmFjY2lCbG9jayA9IGZpYm9uYWNjaUJsb2NrTWFrZXIobnVtYmVyKTtcclxuICAgIGNvbnN0IGZ1bmN0aW9uVmFsdWVUZXh0ID0gZmlib25hY2NpQmxvY2sucXVlcnlTZWxlY3RvcignLmZpYm9uYWNjaS1ibG9ja19fcmV0dXJuLXZhbHVlJyk7XHJcbiAgICBjb25zdCBmdW5jdGlvbk5hbWVCbG9jayA9IGZpYm9uYWNjaUJsb2NrLnF1ZXJ5U2VsZWN0b3IoJy5maWJvbmFjY2ktYmxvY2tfX2Z1bmN0aW9uLW5hbWUnKTtcclxuICAgIHBhcmVudERPTVJlZi5hcHBlbmRDaGlsZChmaWJvbmFjY2lCbG9jayk7XHJcblxyXG4gICAgaWYgKG51bWJlciA+IDIpIHtcclxuICAgICAgICB5aWVsZDtcclxuICAgIH1cclxuICAgIFxyXG5cclxuICAgIGxldCB2YWx1ZSA9IDA7XHJcbiAgICBpZiAobnVtYmVyID09IDEgfHwgbnVtYmVyID09IDIpIHtcclxuICAgICAgICB2YWx1ZSA9IDE7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIGxldCBnZW5lcmF0b3IxID0gZmliKG51bWJlciAtIDEsIGZpYm9uYWNjaUJsb2NrKTtcclxuICAgICAgICBsZXQgbmV4dDEgPSBnZW5lcmF0b3IxLm5leHQoKTtcclxuICAgICAgICBsZXQgeWllbGRlZFZhbHVlMTtcclxuICAgICAgICB3aGlsZSAoIW5leHQxLmRvbmUpIHtcclxuICAgICAgICAgICAgeWllbGRlZFZhbHVlMSA9IG5leHQxLnZhbHVlO1xyXG4gICAgICAgICAgICB5aWVsZDtcclxuICAgICAgICAgICAgbmV4dDEgPSBnZW5lcmF0b3IxLm5leHQoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFsdWUgKz0geWllbGRlZFZhbHVlMTtcclxuXHJcbiAgICAgICAgbGV0IGdlbmVyYXRvcjIgPSBmaWIobnVtYmVyIC0gMiwgZmlib25hY2NpQmxvY2spO1xyXG4gICAgICAgIGxldCBuZXh0MiA9IGdlbmVyYXRvcjIubmV4dCgpO1xyXG4gICAgICAgIGxldCB5aWVsZGVkVmFsdWUyO1xyXG4gICAgICAgIHdoaWxlICghbmV4dDIuZG9uZSkge1xyXG4gICAgICAgICAgICB5aWVsZGVkVmFsdWUyID0gbmV4dDIudmFsdWU7XHJcbiAgICAgICAgICAgIHlpZWxkO1xyXG4gICAgICAgICAgICBuZXh0MiA9IGdlbmVyYXRvcjIubmV4dCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YWx1ZSArPSB5aWVsZGVkVmFsdWUyO1xyXG4gICAgfVxyXG4gICAgXHJcblxyXG4gICAgZnVuY3Rpb25WYWx1ZVRleHQuaW5uZXJIVE1MID0gdmFsdWUudG9TdHJpbmcoKTtcclxuICAgIGZ1bmN0aW9uVmFsdWVUZXh0LmNsYXNzTGlzdC5hZGQoJ2ZpYm9uYWNjaS1ibG9ja19fcmV0dXJuLXZhbHVlLS1yZXR1cm5lZCcpO1xyXG4gICAgZnVuY3Rpb25OYW1lQmxvY2suY2xhc3NMaXN0LmFkZCgnZmlib25hY2NpLWJsb2NrX19mdW5jdGlvbi1uYW1lLS1yZXNvbHZlZCcpO1xyXG4gICAgXHJcbiAgICB5aWVsZCB2YWx1ZTsgICAgXHJcbn1cclxuXHJcbmZ1bmN0aW9uIHRyaWFsKGdlbmVyYXRvciwgZ2VuZXJhdG9yWWllbGQpIHtcclxuICAgIGxldCBjb2RlU3RlcHBlciA9IHNldFRpbWVvdXQoZnVuY3Rpb24gc3RlcChnZW5lcmF0b3IsIGdlbmVyYXRvcllpZWxkKSB7XHJcbiAgICAgICAgaWYgKGdlbmVyYXRvcllpZWxkICYmIGdlbmVyYXRvcllpZWxkLmRvbmUpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGdlbmVyYXRvcllpZWxkID0gZ2VuZXJhdG9yLm5leHQoKTtcclxuICAgICAgICAgICAgY29kZVN0ZXBwZXIgPSBzZXRUaW1lb3V0KHN0ZXAsIDMwMCwgZ2VuZXJhdG9yLCBnZW5lcmF0b3JZaWVsZCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSwgMzAwLCBnZW5lcmF0b3IsIGdlbmVyYXRvcllpZWxkKTtcclxufVxyXG5cclxuLy8gdHJpYWwoZmliKDEwLCBmaWJvbmFjY2lEZW1vQ29udGFpbmVyKSwgbnVsbCk7XHJcblxyXG5jb25zdCBmaWJHZW5lcmF0b3JNYWtlciA9IG5ldyBGaWJvbmFjY2lHZW5lcmF0b3JNYWtlcigpO1xyXG4vLyB0cmlhbChmaWJHZW5lcmF0b3JNYWtlci5maWJvbmFjY2koNywgZmlib25hY2NpRGVtb0NvbnRhaW5lciksIG51bGwpO1xyXG5cclxuY29uc3Qgc2ltdWxhdGlvbkNvbnRyb2xsZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc2ltdWxhdGlvbi1jb250cm9sbGVyJyk7XHJcbmNvbnN0IHN0YXJ0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnNpbXVsYXRpb24tY29udHJvbGxlcl9fc3RhcnQtYnV0dG9uJyk7XHJcbmNvbnN0IHNpbXVsYXRpb25GdW5jdGlvblBhcmFtZXRlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zaW11bGF0aW9uLWNvbnRyb2xsZXJfX2Z1bmN0aW9uLXBhcmFtZXRlcicpO1xyXG5jb25zdCBzaW11bGF0aW9uRGVsYXkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc2ltdWxhdGlvbi1jb250cm9sbGVyX19kZWxheScpO1xyXG5cclxuY29uc3QgY29kZVBsYXllciA9IG5ldyBDb2RlUGxheWVyKGZpYkdlbmVyYXRvck1ha2VyLmZpYm9uYWNjaS5iaW5kKGZpYkdlbmVyYXRvck1ha2VyKSwgc2ltdWxhdGlvbkNvbnRyb2xsZXIsICdmaWJvbmFjY2ktZGVtbycpO1xyXG5jb2RlUGxheWVyLnBsYWNlQ29kZVBsYXllckF0TG9jYXRpb24oZmlib25hY2NpV3JhcHBlcik7XHJcblxyXG5jb2RlUGxheWVyLnNpbWx1YXRpb25TdGFydEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGNvZGVQbGF5ZXIuc3RhcnRGdW5jdGlvbik7XHJcbmNvZGVQbGF5ZXIuc2ltdWxhdGlvblBsYXlQYXVzZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGNvZGVQbGF5ZXIudG9nZ2xlUGxheVBhdXNlKTtcclxuY29kZVBsYXllci5zaW11bGF0aW9uUGxheVBhdXNlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY29kZVBsYXllci5wbGF5RnVuY3Rpb24pO1xyXG5jb2RlUGxheWVyLnNpbXVsYXRpb25TdGVwcGVyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY29kZVBsYXllci5zdGVwKTtcclxuXHJcbmZpYm9uYWNjaVdyYXBwZXIuc2Nyb2xsKDQ0MDAsIDApOyJdfQ==
